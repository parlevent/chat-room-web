(function(e){function t(t){for(var r,a,i=t[0],l=t[1],u=t[2],p=0,f=[];p<i.length;p++)a=i[p],s[a]&&f.push(s[a][0]),s[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);c&&c(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var l=n[i];0!==s[l]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},s={app:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var c=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),s=n.n(r);s.a},"0e5a":function(e,t,n){"use strict";var r=n("54a3"),s=n.n(r);s.a},"18fe":function(e,t,n){},"54a3":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"hello"},[n("h1",[e._v(e._s(e.msg))]),e._m(0),n("h3",[e._v("Installed CLI Plugins")]),e._m(1),n("h3",[e._v("Essential Links")]),e._m(2),n("h3",[e._v("Ecosystem")]),e._m(3)])},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("\n    For a guide and recipes on how to configure / customize this project,"),n("br"),e._v("\n    check out the\n    "),n("a",{attrs:{href:"https://cli.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-cli documentation")]),e._v(".\n  ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-babel",target:"_blank",rel:"noopener"}},[e._v("babel")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Core Docs")])]),n("li",[n("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Forum")])]),n("li",[n("a",{attrs:{href:"https://chat.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("Community Chat")])]),n("li",[n("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank",rel:"noopener"}},[e._v("Twitter")])]),n("li",[n("a",{attrs:{href:"https://news.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("News")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",[n("li",[n("a",{attrs:{href:"https://router.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-router")])]),n("li",[n("a",{attrs:{href:"https://vuex.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vuex")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/vue-devtools#vue-devtools",target:"_blank",rel:"noopener"}},[e._v("vue-devtools")])]),n("li",[n("a",{attrs:{href:"https://vue-loader.vuejs.org",target:"_blank",rel:"noopener"}},[e._v("vue-loader")])]),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank",rel:"noopener"}},[e._v("awesome-vue")])])])}],l={name:"HelloWorld",props:{msg:String}},u=l,c=(n("ccd1"),n("2877")),p=Object(c["a"])(u,a,i,!1,null,"379548a4",null),f=(p.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login-card"}},[n("Row",{attrs:{type:"flex",justify:"center"}},[n("div",{staticStyle:{width:"300px"}},[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[e._v("欢迎登录")]),n("div",[n("Form",{ref:"formInline",attrs:{model:e.formInline,rules:e.ruleInline}},[n("FormItem",{attrs:{prop:"user"}},[n("Input",{attrs:{type:"text",placeholder:"用户名"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-person-outline"},slot:"prepend"})],1)],1),n("FormItem",{attrs:{prop:"password"}},[n("Input",{attrs:{type:"password",placeholder:"密码"},model:{value:e.formInline.password,callback:function(t){e.$set(e.formInline,"password",t)},expression:"formInline.password"}},[n("Icon",{attrs:{slot:"prepend",type:"ios-lock-outline"},slot:"prepend"})],1)],1),n("FormItem",[n("Button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit("formInline")}}},[e._v("登录")])],1)],1)],1)])],1)])],1)}),m=[],d=n("f499"),h=n.n(d),v=(n("7f7f"),n("bc3a")),g=n.n(v),_=(n("28a5"),"http://localhost:7777"),b={login:_+"/auth/login",onlineUsers:_+"/onlineUsers",socket:_+"/socket"},y=function(e){e=e.substr(1,e.length-2);var t=e.split(",");return t.map(function(e){return e.substr(1,e.length-2)})},w={endpoints:b,convertSetStrToList:y};g.a.defaults.headers.post["Content-Type"]="application/json";var k={name:"Login",data:function(){return{formInline:{user:"",password:""},ruleInline:{user:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{type:"string",min:6,message:"最少为6个字符",trigger:"blur"}]}}},methods:{handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e?g.a.post(w.endpoints.login,h()({username:t.formInline.user,password:t.formInline.password})).then(function(e){200===e.status&&e.data.status?(t.$router.push({name:"Chat",params:{username:t.formInline.user}}),t.$Message.success("登录成功!")):t.$Message.error("用户名或密码错误，请重试！")}):t.$Message.error("Fail!")})}}},j=k,x=(n("5e3a"),Object(c["a"])(j,f,m,!1,null,"97ec3aac",null)),C=x.exports,I={name:"app",components:{Login:C}},M=I,S=(n("034f"),Object(c["a"])(M,s,o,!1,null,null,null)),$=S.exports,O=n("8c4f"),L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout"},[n("Layout",[n("Header",[n("Menu",{attrs:{mode:"horizontal",theme:"dark","active-name":"1"}},[n("div",{staticClass:"layout-logo"},[e._v("Chat Room")]),n("div",{staticClass:"layout-nav"},[n("p",{staticStyle:{"text-align":"right"}},[e._v(e._s(e.username))])])])],1),n("Layout",[n("Sider",{style:{position:"fixed",height:"100vh",left:0,overflow:"auto",background:"#fff"},attrs:{"hide-trigger":""}},[n("Card",[e._v("当前共"+e._s(e.onlineUsers.length)+"人在线")]),n("Menu",{attrs:{"active-name":e.receiver,theme:"light",width:"auto"},on:{"on-select":e.choose_receiver}},e._l(e.onlineUsers,function(t){return n("MenuItem",{attrs:{name:t}},[e._v(e._s(t))])}),1)],1),n("Layout",{style:{marginLeft:"200px",height:"100%"}},[n("Content",{style:{padding:"24px",height:"100vh",background:"#fff",textAlign:"left"}},[n("div",{staticClass:"msg-display",domProps:{innerHTML:e._s(e.messages)}}),n("div",{staticClass:"msg-op"},[n("Row",{attrs:{type:"flex",align:"bottom"}},[n("i-col",{attrs:{span:"22"}},[n("i-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"Enter something..."},model:{value:e.input_msg,callback:function(t){e.input_msg=t},expression:"input_msg"}})],1),n("i-col",{style:{textAlign:"center"},attrs:{span:"2"}},[n("i-button",{attrs:{type:"primary",disabled:""===e.input_msg||null===e.receiver||""===e.receiver},on:{click:e.sendMsg}},[e._v("发送\n                                ")])],1)],1)],1)])],1)],1)],1)],1)},E=[],U=n("cc7d"),P=n.n(U),T=n("74d1"),F=n.n(T),J={name:"Chat",data:function(){return{username:"traveller",receiver:"",input_msg:"",stompClient:null,messages:"",onlineUsers:[]}},methods:{sendMsg:function(){this.stompClient.send("/app/sendMsg",{},h()({sender:this.username,receiver:this.receiver,content:this.input_msg})),this.messages+=this.wrapMsg("我",this.input_msg),this.input_msg=""},choose_receiver:function(e){e!==this.receiver&&(this.receiver=e,this.messages="")},wrapMsg:function(e,t){return"<p>"+e+"</p><p>"+t+"</p><br/>"}},mounted:function(){var e=this;"username"in this.$route.params&&(this.username=this.$route.params.username,this.onlineUsers.push(this.username));var t=new P.a(w.endpoints.socket);this.stompClient=F.a.over(t),this.stompClient.connect({},function(){console.log("Connect successfully!"),e.stompClient.subscribe("/user/"+e.username+"/msg",function(t){console.log("received: "+JSON.parse(t.body).content);var n=JSON.parse(t.body);e.messages+=e.wrapMsg(n.sender,n.content)}),e.stompClient.subscribe("/topic/broadcastMsg",function(t){e.messages+=JSON.parse(t.body).content;var n=JSON.parse(t.body);e.messages+=e.wrapMsg("【管理员消息】"+n.sender,n.content)}),e.stompClient.subscribe("/topic/login",function(t){e.onlineUsers=w.convertSetStrToList(t.body)})}),g.a.get(w.endpoints.onlineUsers).then(function(t){console.log(t),e.onlineUsers=t.data})}},N=J,R=(n("0e5a"),Object(c["a"])(N,L,E,!1,null,"ec752bcc",null)),z=R.exports,H=n("e069"),q=n.n(H);n("dcad");r["default"].use(O["a"]);var A=new O["a"]({mode:"history",routes:[{path:"/",component:$,children:[{path:"",redirect:C},{path:"/login",name:"Login",component:C},{path:"/chat",name:"Chat",component:z}]}]});r["default"].use(q.a),r["default"].config.productionTip=!1,new r["default"]({render:function(e){return e($)},router:A}).$mount("#app")},"5e3a":function(e,t,n){"use strict";var r=n("67ef"),s=n.n(r);s.a},"64a9":function(e,t,n){},"67ef":function(e,t,n){},ccd1:function(e,t,n){"use strict";var r=n("18fe"),s=n.n(r);s.a}});
//# sourceMappingURL=app.8a656902.js.map